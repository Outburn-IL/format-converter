<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Format Converter - Full Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .warning-banner {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e74c3c;
            box-shadow: 0 2px 8px rgba(231, 76, 60, 0.3);
        }
        .warning-banner strong {
            font-size: 1.1em;
        }
        .subtitle {
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        .demo-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }
        .demo-section h2 {
            color: #34495e;
            margin-top: 0;
        }
        textarea {
            width: 100%;
            height: 150px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            resize: vertical;
        }
        textarea:focus {
            border-color: #3498db;
            outline: none;
        }
        .results {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #3498db;
        }
        .error {
            border-left-color: #e74c3c;
        }
        .success {
            border-left-color: #27ae60;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 13px;
            max-height: 300px;
        }
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .feature {
            padding: 15px;
            background: #ecf0f1;
            border-radius: 5px;
            text-align: center;
        }
        .feature strong {
            color: #2c3e50;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background: #2980b9;
        }
        .button-group {
            margin-bottom: 10px;
        }
        select {
            padding: 5px 10px;
            margin-right: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ Format Converter - Full Demo</h1>
        <p class="subtitle">Comprehensive format conversion and type detection in the browser</p>
        
        <div class="warning-banner">
            <strong>‚ö†Ô∏è Browser Compatibility Notice</strong><br>
            This demo requires FormatConverter functionality that is not available in the browser build due to HL7.js dependencies.
            For full functionality including CSV, XML, and HL7 conversions, please use the Node.js version of this library.
        </div>

        <div class="demo-section">
            <h2>CSV to JSON Converter</h2>
            <textarea id="csvInput" placeholder="Enter CSV data here...">name,age,city,active
John Doe,30,New York,true
Jane Smith,25,London,false
Bob Johnson,35,Paris,true
Alice Brown,28,Tokyo,true</textarea>
            <div class="button-group">
                <button onclick="convertCsv()">Convert CSV to JSON</button>
                <button onclick="loadCsvExample()">Load Example</button>
            </div>
            <div id="csvResults" class="results" style="display:none;">
                <strong>JSON Result:</strong>
                <pre id="csvOutput"></pre>
            </div>
        </div>

        <div class="demo-section">
            <h2>XML to JSON Converter</h2>
            <textarea id="xmlInput" placeholder="Enter XML data here...">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;catalog&gt;
  &lt;book id="1"&gt;
    &lt;title&gt;The Great Gatsby&lt;/title&gt;
    &lt;author&gt;F. Scott Fitzgerald&lt;/author&gt;
    &lt;year&gt;1925&lt;/year&gt;
    &lt;price&gt;12.99&lt;/price&gt;
  &lt;/book&gt;
  &lt;book id="2"&gt;
    &lt;title&gt;To Kill a Mockingbird&lt;/title&gt;
    &lt;author&gt;Harper Lee&lt;/author&gt;
    &lt;year&gt;1960&lt;/year&gt;
    &lt;price&gt;14.99&lt;/price&gt;
  &lt;/book&gt;
&lt;/catalog&gt;</textarea>
            <div class="button-group">
                <button onclick="convertXml()">Convert XML to JSON</button>
                <button onclick="loadXmlExample()">Load Example</button>
            </div>
            <div id="xmlResults" class="results" style="display:none;">
                <strong>JSON Result:</strong>
                <pre id="xmlOutput"></pre>
            </div>
        </div>

        <div class="demo-section">
            <h2>Type Detection & Conversion</h2>
            <textarea id="typeInput" placeholder="Enter values to detect types (one per line)...">42
3.14159
true
false
hello world
2023-12-04
2023-12-04T10:30:00Z
null
undefined</textarea>
            <div class="button-group">
                <button onclick="detectTypes()">Detect Types</button>
                <button onclick="convertTypes()">Convert & Detect</button>
                <select id="targetType">
                    <option value="auto">Auto Detect</option>
                    <option value="string">String</option>
                    <option value="number">Number</option>
                    <option value="boolean">Boolean</option>
                    <option value="date">Date</option>
                </select>
            </div>
            <div id="typeResults" class="results" style="display:none;">
                <strong>Type Detection Results:</strong>
                <pre id="typeOutput"></pre>
            </div>
        </div>

        <div class="demo-section">
            <h2>Format Detection</h2>
            <textarea id="formatInput" placeholder="Enter data to detect format...">name,age,city
John,30,NYC
Jane,25,LA</textarea>
            <div class="button-group">
                <button onclick="detectFormat()">Detect Format</button>
                <button onclick="loadFormatExamples()">Load Examples</button>
            </div>
            <div id="formatResults" class="results" style="display:none;">
                <strong>Format Detection Result:</strong>
                <pre id="formatOutput"></pre>
            </div>
        </div>

        <div class="features">
            <div class="feature">
                <strong>üìä CSV Support</strong><br>
                Parse CSV with headers and type detection
            </div>
            <div class="feature">
                <strong>üìÑ XML Support</strong><br>
                Convert XML to JSON with attributes
            </div>
            <div class="feature">
                <strong>üîç Type Detection</strong><br>
                Auto-detect strings, numbers, booleans, dates
            </div>
            <div class="feature">
                <strong>üîÑ Format Detection</strong><br>
                Automatically identify data formats
            </div>
            <div class="feature">
                <strong>‚ö° Browser-First</strong><br>
                No server-side dependencies
            </div>
            <div class="feature">
                <strong>üõ†Ô∏è Type Conversion</strong><br>
                Convert between different data types
            </div>
        </div>
    </div>

    <script src="../dist/browser/browser.js"></script>
    <script>
        // Global variables for the demo
        let formatConverter, typeConverter;
        
        // Initialize the library
        function initializeLibrary() {
            try {
                if (typeof FormatConverter !== 'undefined') {
                    const { FormatConverter: FC, TypeConverter } = FormatConverter;
                    formatConverter = new FC();
                    typeConverter = new TypeConverter();
                    console.log('‚úÖ Format Converter library initialized successfully');
                    return true;
                } else {
                    console.error('‚ùå FormatConverter is not available');
                    return false;
                }
            } catch (error) {
                console.error('‚ùå Failed to initialize library:', error.message);
                return false;
            }
        }

        function showResult(elementId, content, isError = false) {
            const element = document.getElementById(elementId);
            const outputElement = document.getElementById(elementId.replace('Results', 'Output'));
            
            if (outputElement) {
                outputElement.textContent = content;
            } else {
                element.innerHTML = isError ? `<strong>Error:</strong> ${content}` : content;
            }
            
            element.className = isError ? 'results error' : 'results success';
            element.style.display = 'block';
        }

        function convertCsv() {
            if (!formatConverter) {
                showResult('csvResults', 'Library not initialized', true);
                return;
            }

            try {
                const csvData = document.getElementById('csvInput').value;
                const result = formatConverter.convertFromCsv(csvData);
                showResult('csvResults', JSON.stringify(result, null, 2));
            } catch (error) {
                showResult('csvResults', error.message, true);
            }
        }

        function convertXml() {
            if (!formatConverter) {
                showResult('xmlResults', 'Library not initialized', true);
                return;
            }

            try {
                const xmlData = document.getElementById('xmlInput').value;
                const result = formatConverter.convertFromXml(xmlData);
                showResult('xmlResults', JSON.stringify(result, null, 2));
            } catch (error) {
                showResult('xmlResults', error.message, true);
            }
        }

        function detectTypes() {
            if (!typeConverter) {
                showResult('typeResults', 'Library not initialized', true);
                return;
            }

            try {
                const input = document.getElementById('typeInput').value;
                const lines = input.split('\n').filter(line => line.trim());
                
                const results = lines.map(line => {
                    const trimmed = line.trim();
                    const detectedType = typeConverter.detectType(trimmed);
                    return `"${trimmed}" ‚Üí ${detectedType}`;
                });
                
                showResult('typeResults', results.join('\n'));
            } catch (error) {
                showResult('typeResults', error.message, true);
            }
        }

        function convertTypes() {
            if (!typeConverter) {
                showResult('typeResults', 'Library not initialized', true);
                return;
            }

            try {
                const input = document.getElementById('typeInput').value;
                const targetType = document.getElementById('targetType').value;
                const lines = input.split('\n').filter(line => line.trim());
                
                const results = lines.map(line => {
                    const trimmed = line.trim();
                    const detectedType = typeConverter.detectType(trimmed);
                    
                    try {
                        let converted;
                        if (targetType === 'auto') {
                            converted = typeConverter.convertValue(trimmed, detectedType);
                        } else {
                            converted = typeConverter.convertValue(trimmed, targetType);
                        }
                        
                        return `"${trimmed}" (${detectedType}) ‚Üí ${JSON.stringify(converted)} (${typeof converted})`;
                    } catch (convertError) {
                        return `"${trimmed}" (${detectedType}) ‚Üí Error: ${convertError.message}`;
                    }
                });
                
                showResult('typeResults', results.join('\n'));
            } catch (error) {
                showResult('typeResults', error.message, true);
            }
        }

        function detectFormat() {
            if (!formatConverter) {
                showResult('formatResults', 'Library not initialized', true);
                return;
            }

            try {
                const input = document.getElementById('formatInput').value;
                // Try to detect format based on content
                const result = formatConverter.detectFormat ? 
                    formatConverter.detectFormat(input) : 
                    'Format detection not available';
                
                showResult('formatResults', typeof result === 'string' ? result : JSON.stringify(result, null, 2));
            } catch (error) {
                showResult('formatResults', error.message, true);
            }
        }

        // Example loaders
        function loadCsvExample() {
            document.getElementById('csvInput').value = `name,age,city,salary,active,joinDate
John Doe,30,New York,75000,true,2020-01-15
Jane Smith,25,London,68000,false,2021-03-22
Bob Johnson,35,Paris,82000,true,2019-07-08
Alice Brown,28,Tokyo,71000,true,2022-02-14`;
        }

        function loadXmlExample() {
            document.getElementById('xmlInput').value = `<?xml version="1.0" encoding="UTF-8"?>
<employees>
  <employee id="1" active="true">
    <name>John Doe</name>
    <position>Software Engineer</position>
    <department>Engineering</department>
    <salary>75000</salary>
    <joinDate>2020-01-15</joinDate>
  </employee>
  <employee id="2" active="false">
    <name>Jane Smith</name>
    <position>Product Manager</position>
    <department>Product</department>
    <salary>85000</salary>
    <joinDate>2019-08-22</joinDate>
  </employee>
</employees>`;
        }

        function loadFormatExamples() {
            const examples = [
                'CSV format:\nname,age\nJohn,30\nJane,25',
                'XML format:\n<person><name>John</name><age>30</age></person>',
                'JSON format:\n{"name": "John", "age": 30}'
            ];
            
            let currentExample = 0;
            const input = document.getElementById('formatInput');
            
            return function() {
                input.value = examples[currentExample];
                currentExample = (currentExample + 1) % examples.length;
            };
        }

        // Initialize when page loads
        window.addEventListener('load', () => {
            if (initializeLibrary()) {
                // Auto-run some examples
                loadCsvExample();
                loadXmlExample();
            }
        });
    </script>
</body>
</html>